# MultiScreenMate - 讲解员助手/多屏助手

在类似展厅、教室等有多块多电脑屏幕需要执行简单的键盘操作，例如向上、向下、向左、向右、暂停、播放等，要在多块屏幕之间切换，使用键盘或鼠标的实体操作方式都比较麻烦。
该方案在每台电脑上安装一个后端按键服务，结合NFC技术，使用一台安卓手机即可实时快速切换控制，特别适合小型展厅的讲解员的操作。

## 功能特性

### 🎯 核心功能
- **NFC标签识别**：自动读取NFC标签ID并匹配设备
- **网络扫描**：自动扫描局域网内的主机设备（开启了wss服务的主机，主机项目）
- **远程控制**：通过WebSocket连接控制远程主机
- **自定义界面**：可拖拽调整的控制按钮布局

### 🔧 技术特性
- **现代化UI**：基于Jetpack Compose和Material Design 3
- **实时通信**：使用WebSocket进行低延迟控制
- **配置持久化**：自动保存CIDR、端口和按钮布局配置
- **自定义按键**：支持按钮的拖拽和缩放操作

## 项目结构

```
app/src/main/java/com/bestlink/screenmate/
├── MainActivity.kt          # 主界面，设备扫描和NFC功能
├── ControlActivity.kt       # 控制界面入口
├── CustomControlScreen.kt   # 自定义控制界面实现
├── HostSettingsActivity.kt  # 主机设置界面
├── ButtonLayoutManager.kt   # 按钮布局管理
├── config/
│   └── ConfigManager.kt     # 配置管理
├── net/
│   ├── Host.kt              # 主机数据模型
│   ├── HostScanner.kt       # 网络扫描器
│   └── WsClient.kt          # WebSocket客户端
└── util/
    └── UUIDManager.kt       # 设备ID管理
```

## 快速开始

### 环境要求
- Android Studio Arctic Fox 或更高版本
- Android SDK 30+
- Java 11+

### 安装步骤
1. 克隆项目到本地
2. 使用Android Studio打开项目
3. 连接Android设备或启动模拟器
4. 点击运行按钮安装应用

### 基本使用流程

1. **扫描设备**
   - 启动应用后，输入CIDR地址和端口
   - 点击"扫描"按钮发现局域网内的主机

2. **配置主机**
   - 长按主机卡片进入设置界面
   - 设置主机名称和NFC标签ID

3. **NFC控制**
   - 将NFC标签贴近手机
   - 应用自动识别标签并跳转到对应主机的控制界面

4. **自定义控制界面**
   - 进入控制界面后，点击编辑按钮
   - 拖拽按钮调整位置，双指缩放调整大小
   - 点击保存按钮保存布局配置

## 详细功能说明

### NFC功能
- 自动读取NFC标签ID并显示
- 匹配已配置的主机Tag ID
- 自动跳转到对应主机的控制界面
- 支持多种NFC技术类型（NFC-A/B/F/V）

### 网络扫描
- 支持CIDR格式（掩码24-32）
- 实时显示扫描进度
- 自动保存扫描配置
- 支持自定义端口号

### 自定义控制界面
- 五个预设按钮：上、下、左、右、中
- 支持拖拽移动按钮位置
- 支持双指缩放调整按钮大小
- 布局配置自动保存和加载

### 按键配置
- 支持自定义按键映射
- 可配置音量键功能
- 配置信息持久化存储

## 配置说明

### CIDR配置
应用启动时自动读取`cidr.txt`文件中的CIDR配置，格式如：`192.168.1.0/24`

### 端口配置
应用启动时自动读取`port.txt`文件中的端口配置，默认端口：`56789`

### 按钮布局配置
按钮布局信息保存在`button_layout.json`文件中，包含每个按钮的位置、大小和命令映射。

## 开发说明

### 主要技术栈
- **UI框架**：Jetpack Compose + Material Design 3
- **网络通信**：WebSocket + OkHttp
- **数据持久化**：SharedPreferences + JSON文件
- **NFC功能**：Android NFC API

### 核心类说明

#### MainActivity
主界面Activity，负责：
- 设备扫描和显示
- NFC标签读取和处理
- 配置管理界面

#### CustomControlScreen
自定义控制界面Composable，实现：
- 按钮拖拽和缩放手势
- 布局配置的保存和加载
- 实时控制命令发送

#### HostScanner
网络扫描器，功能包括：
- CIDR地址解析和验证
- 多线程并发扫描
- 主机连接状态检测

## 故障排除

### 常见问题

1. **扫描不到设备**
   - 检查CIDR地址是否正确
   - 确认目标设备运行了对应的服务端程序
   - 检查防火墙设置

2. **NFC功能不工作**
   - 确认设备支持NFC功能
   - 检查NFC是否已启用
   - 验证NFC标签格式是否兼容

3. **控制命令不生效**
   - 检查网络连接状态
   - 确认服务端程序正常运行
   - 查看日志输出排查问题

### 日志调试
应用使用Android标准日志系统，关键标签：
- `NFC`：NFC相关操作日志
- `WebSocket`：网络通信日志
- `Control`：控制界面操作日志

## 许可证

本项目采用MIT许可证，详见LICENSE文件。

## 贡献指南

欢迎提交Issue和Pull Request来改进这个项目。

## 联系方式

如有问题或建议，请通过以下方式联系：
- 提交GitHub Issue
- 发送邮件至项目维护者

---

**注意**：使用本应用需要对应的服务端程序支持，请确保目标设备已安装并运行相应的服务端软件。
